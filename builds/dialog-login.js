define(["require","api","common"],function(e,t,n){var r=null,i,s={extobj:{data:null,listPlugin:[],el:"#loginTpl-dialog",events:{"click .submit-btn":"onsubmit","click .cancel-btn":"oncancel"},initialize:function(e){var t=this;t.listenTo(Backbone.Events,"login:box",function(e){console.log(e),localStorage.setItem("userinfo",JSON.stringify(e)),window.location.href="#/manage/station",window.location.reload(),t.oncancel()}),t.listenTo(Backbone.Events,"login:box:fail",function(e){alert("登录失败，请重试")})},setValue:function(){},getParam:function(){return n.getFormValue(this.el,!0)},showErrTips:function(e){return alert(e),!1},validate:function(e){return!0},onsubmit:function(){var e=this,n=e.getParam();n.refresh=1,e.validate(n)&&t.login(n)},oncancel:function(){this.stopListening(),this.dialogObj.dialog("destroy"),$(".ui-dialog,.ui-widget-overlay").remove(),i=""}}};return{show:function(){var e=$("#loginTpl-dialog").length?$("#loginTpl-dialog").replaceWith($($("#loginTpl").html())):$($("#loginTpl").html());e.dialog({modal:!0,show:300,height:250,width:500,title:"切换用户",close:function(e,t){r.oncancel()},open:function(){$("form.jqtransform").jqTransform(),r=new(Backbone.View.extend(s.extobj)),r.dialogObj=$(this)}})},detroy:function(){r.oncancel()}}});